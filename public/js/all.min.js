"use strict";!function(){Number.prototype.gw2Num=function(){let e=this%100,t=(this-e)%1e4/100,i=(this-e-100*t)/1e4,s="";return i&&(s+=i+"<img class='clipped-money' title='gold' src='https://render.guildwars2.com/file/090A980A96D39FD36FBB004903644C6DBEFB1FFB/156904.png'> "),t&&(s+=t+"<img class='clipped-money' title='silver' src='https://render.guildwars2.com/file/E5A2197D78ECE4AE0349C8B3710D033D22DB0DA6/156907.png'> "),e&&(s+=e+"<img class='clipped-money' title='copper' src='https://render.guildwars2.com/file/6CF8F96A3299CFC75D5CC90617C3C70331A1EF0E/156902.png'> "),s};new Vue({data:{items:[],page:1,lastPage:1,searchTerm:"",includeUnsell:!1,searchStatus:2,bgImg:null,debounceTimer:null,loadingRecipes:!1,recipeBox:{show:!1,recipes:[]}},methods:{getBg(){let e=Math.floor(63*Math.random())+1;console.log("getting specialization",e),fetch("https://api.guildwars2.com/v2/specializations/"+e).then((e=>e.json())).then((e=>this.bgImg=e.background))},getSearchResults(){console.log("search string:",`/find?search=${this.searchTerm}&page=${this.page}${this.includeUnsell?"&ius":""}`),fetch(`/find?search=${this.searchTerm}&page=${this.page}${this.includeUnsell?"&ius":""}`).then((e=>e.json())).then((e=>{console.log(e),this.items=e.results,this.searchStatus=e.searchStatus,this.page=e.page,this.lastPage=e.lastPage}))},newSearch(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((async()=>{this.searchStatus=0,this.page=1,this.items=[],this.getSearchResults()}),500)},changePage(e){!e&&this.page>1?(this.searchStatus=0,this.items=[],this.page--,this.getSearchResults()):e&&this.page<this.lastPage&&(this.searchStatus=0,this.items=[],this.page++,this.getSearchResults())},async getRecipes(e,t){let i=null,s=`/recipes?id=${e.id}&type=`;this.loadingRecipes=!0,this.recipeBox.show=!0,i=t?await fetch(s+"ingredient").then((e=>e.json())):await fetch(s+"result").then((e=>e.json())),this.recipeBox.recipes=i,i&&i.length||(bulmabox.alert("No Recipes",`Sorry, but I can't find any recipes for <img src='${e.img}' class='tiny-img'> ${e.name} as ${t?"an ingredient":"a result"}!`),this.recipeBox.show=!1),this.loadingRecipes=!1},profit:(e,t)=>t?e.output.count*e.output.buy-e.ingrs.reduce(((e,t)=>e+t.sell*t.count),0):e.output.count*e.output.sell-e.ingrs.reduce(((e,t)=>e+t.buy*t.count),0)},created(){this.getBg(),localStorage.gw2PricerShowedHelp||(localStorage.gw2PricerShowedHelp=!0,bulmabox.alert("Guild Wars 2 Recipe Tool",'Hi! Welcome to the Guild Wars 2 Recipe Checker Tool!\n            <div class=\'content\'>\n                <hr>\n                <div class="is-size-4">\n                    What It Is:\n                </div>\n                The Guild Wars 2 Recipe Checker Tool (GW2RCT) is a tool for the MMO Guild Wars 2 (by ArenaNet, LLC). It allows you to search for an item and then obtain all recipes for that item. \n                <hr>\n                <div class="is-size-4">\n                    How to Use:\n                </div>\n                Usage is pretty simple. Just:\n                <ol>\n                    <li>Enter some search terms in the Item Search box.</li>\n                    <li>Wait for your results to (hopefully!) show up.</li>\n                    <li>Pick an item from the list of returned results</li>\n                    <li>Now, decide whether you want that item to be an <i>ingredient</i> or a <i>result</i> of a recipe. <br>For example, Iron Ingots are the <i>result</i> of a recipe involving Iron Ore, but they\'re also an <i>ingredient</i> of a recipe to make Iron Plated Dowels</li>\n                    <li>Click either Result or Ingredient as appropriate</li>\n                    <li>View your recipes! Take particular note of the Profit columns.</li>\n                </ol>\n                <hr/>\n                Have fun!\n                <br/>-Dave\n            </div>\n            '))},computed:{bgStyle(){return`background-color:#000; background-image:linear-gradient(transparent,#000),url('${this.bgImg}'); background-repeat: no-repeat; background-size:160% auto `}}}).$mount("#main")}();