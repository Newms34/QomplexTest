"use strict";!function(){Number.prototype.gw2Num=function(){let e=this%100,t=(this-e)%1e4/100,s=(this-e-100*t)/1e4,i="";return s&&(i+=s+"<img class='clipped-money' title='gold' src='https://render.guildwars2.com/file/090A980A96D39FD36FBB004903644C6DBEFB1FFB/156904.png'> "),t&&(i+=t+"<img class='clipped-money' title='silver' src='https://render.guildwars2.com/file/E5A2197D78ECE4AE0349C8B3710D033D22DB0DA6/156907.png'> "),e&&(i+=e+"<img class='clipped-money' title='copper' src='https://render.guildwars2.com/file/6CF8F96A3299CFC75D5CC90617C3C70331A1EF0E/156902.png'> "),i};new Vue({data:{items:[],page:1,lastPage:1,searchTerm:"",includeUnsell:!1,searchStatus:2,bgImg:null,debounceTimer:null,loadingRecipes:!1,recipeBox:{show:!1,recipes:[]}},methods:{getBg(){let e=Math.floor(63*Math.random())+1;console.log("getting specialization",e),fetch("https://api.guildwars2.com/v2/specializations/"+e).then((e=>e.json())).then((e=>this.bgImg=e.background))},getSearchResults(){console.log("search string:",`/find?search=${this.searchTerm}&page=${this.page}${this.includeUnsell?"&ius":""}`),fetch(`/find?search=${this.searchTerm}&page=${this.page}${this.includeUnsell?"&ius":""}`).then((e=>e.json())).then((e=>{console.log(e),this.items=e.results,this.searchStatus=e.searchStatus,this.page=e.page,this.lastPage=e.lastPage}))},newSearch(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((async()=>{this.searchStatus=0,this.page=1,this.items=[],this.getSearchResults()}),500)},changePage(e){!e&&this.page>1?(this.searchStatus=0,this.items=[],this.page--,this.getSearchResults()):e&&this.page<this.lastPage&&(this.searchStatus=0,this.items=[],this.page++,this.getSearchResults())},async getRecipes(e,t){let s=null,i=`/recipes?id=${e.id}&type=`;this.loadingRecipes=!0,this.recipeBox.show=!0,s=t?await fetch(i+"ingredient").then((e=>e.json())):await fetch(i+"result").then((e=>e.json())),this.recipeBox.recipes=s,s&&s.length||(bulmabox.alert("No Recipes",`Sorry, but I can't find any recipes for <img src='${e.img}' class='tiny-img'> ${e.name} as ${t?"an ingredient":"a result"}!`),this.recipeBox.show=!1),this.loadingRecipes=!1},profit:(e,t)=>t?e.output.count*e.output.buy-e.ingrs.reduce(((e,t)=>e+t.sell*t.count),0):e.output.count*e.output.sell-e.ingrs.reduce(((e,t)=>e+t.buy*t.count),0)},created(){this.getBg()},computed:{bgStyle(){return`background-color:#000; background-image:linear-gradient(transparent,#000),url('${this.bgImg}'); background-repeat: no-repeat; background-size:160% auto `}}}).$mount("#main")}();